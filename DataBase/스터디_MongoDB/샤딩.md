6.16 3교시 16분부터~

Sharding 이란?

- 데이터를 여러 서버에 분할하는 것을 말한다.
- MongoDB의 데이터의 분할은 상황에 따라 각 Shard로 이동되어 MongoDB 이용자(앱, 웹)는 여러 서버를 인식하지 않고 데이터를 적재시킨다.
- 복제는 동일한 데이터의 사본을 여러 DB에 가지고 있는 반면, Sharding은 여러개의 다른 데이터를 여러 서버(DB)에 가진다.
- 보통의 몽고DB 운영은 Sharding + ReplicaSet으로 구성된다.  



1. 샤드
   - 실제로 데이터가 저장되어 있는 mongod 프로세스 이며, 하나의 문서는 하나의 샤드에 저장되어 샤드간의 데이터 복제는 하지 않는다.
   - ReplicaSet(복제)를 구성하는 것을 권장
2. config 서버
   - 샤드 메타 데이터를 관리하는 mongod 프로세스로 단일 장애 지점이 된다.
   - config는 설정을 담당하는 말
3. mongos 서버
   - 샤드의 라우팅 프로세스이다.
   - 샤드와 클라이언트를 연계 시킨다.
   - 필요하다면 여러개의 mongos 서버를 가질 수 있다.
   - 상태값, 데이터는 전혀 가지고 있다. (연결과 실행만 시켜준다.)
4. 샤드 키
   - 데이터를 분산하는 범위의 키로 복수 지정할 수 없다.
   - 키에 어떤 범위의 데이터가 어떤 샤드에 저장되는지를 MongoDB가 관리하고 데이터의 편차에 따라 자동으로 조정된다.
5. 청크
   - 샤드의 덩어리를 말하며 분산 데이터의 단위
   - 구체적으로는 컬렉션의 연속 된 범위의 데이터의 문서를 말한다.
   - 청크의 최대 크기에 도달하면 분할 된 샤드가 가지고 있는 청크 수에 따라 필요한 경우 다른 샤드로 데이터가 이동된다.
   - 청크의 최대 크기는 변경 할 수 있다.



45분부터 이어서 듣기



-구축

샤드 따로, 복제셋 따로, 샤드머신에 복제셋을 같이 쓰던가 한다.









