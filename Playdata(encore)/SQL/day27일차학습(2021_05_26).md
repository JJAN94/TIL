Day27일차

1. 테이블 데이터 조작을 구현하는 명령을 수행할 수 있다
2. INSERT 문을 이용한 테이블 새로운 행 추가
3. UPDATE문을 기존 데이터 수정
4. DELETE문을 이용한 기존 데이터 삭제
5. MERGE문을 이용한 테이블 병합
6. COMMIT, ROLLBACK, SAVEPOINT를 이용한 트랜잭션 제어





---

### INSERT

```sql
INSERT INTO TABLE명[컬럼명,,,]
			VALUES(값,,,);
```

- 테이블에 열목록을 사용하지 않는 경우에는 테이블의 기존 열 순서에 따라 모두 나열해야 한다.
- 열목록은 테이블의 순서와 같을 필요는 없다.
- INSERT INTO EMP (DEPTNO, ENAME) VALUES(50,'888)
- VALUES절에 나열된 열의 순서와 개수는 INSERT 절에 나열된 열의 순서 및 개수와 같아야한다.
- 문자 및 날짜는 작은 따옴표로 묶는다.
- 숫자 값을 작은 따옴표로 묶으면 암시적 변환이 발생할 수 있다.
- 입력할 데이터가 없을 경우 NULL 또는 ' '로 대입한다. 만일 제약조건에 DEFAULT가 있다면 DEFAULT값으로 저장된다.

---

```sql
DROP TABLE TEST;

CREATE TABLE TEST
AS
SELECT * FROM EMP;
```

Q1) 특정행을 삽입해 보자.

```sql
INSERT INTO TEST(EMPNO, ENAME, HIREDATE)
VALUES(7233,'PAUL',SYSDATE);
```



Q2) 사원의 번호, 사용자 이름, 봉급을 입력해보자.

```sql
INSERT INTO TEST(EMPNO, ENAME, SAL)
VALUES(7234,USER,3400);
--USER : SCOTT
```



Q3) 날짜 값을 입력해보자 TO_DATE()

```sql
INSERT INTO TEST(EMPNO, ENAME, HIREDATE)
VALUES (7533, 'EVLIS', TO_DATE('1997-02-05','YYYY-MM-DD'));

INSERT INTO TEST(EMPNO, ENAME, HIREDATE)
VALUES (7535, 'EVLIS02', '1997/02/07');

INSERT INTO TEST(EMPNO, ENAME, HIREDATE)
VALUES (7535, 'EVLIS03', '1997-02-07');
```



Q4) INSERT 구문 SUBQUERY : INSERT 절의 열의 수와 서브쿼리의 열의 수가 일치해야 한다.

EMP 테이블 사원 중에 A가 있어있는 사원의 정보만 NEW_EMP로 입력하자.

```
한번에 여러개의 행을 입력할 수 있다.
INSERT INTO TABLE[]
SUBQUERY;
```

```sql
CREATE TABLE NEW_EMP(
ID NUMBER(4),
NAME VARCHAR2(10));
```

```sql
INSERT INTO NEW_EMP
SELECT EMPNO, ENAME
FROM EMP
WHERE ENAME LIKE '%A%';
```





---

### UPDATE

UPDATE문을 기존 데이터 수정

- UPDATE구문을 이용해서 특정 열의 값을 변경할 수 있다.
- WHERE 절을 생략하면 테이블의 모든 행이 수정된다.

[형식]

```sql
UPDATE 테이블명
SET COLUMN = VALUES[,,,]
[WHERE CONDTION];
```



Q5) test 테이블의 커미션을 0으로 변경하자.

```sql
UPDATE test
set comm =0;
```



Q6) update한 구문을 취소하자.

```sql
rollback;
```



Q7) test 테이블에서 FORD의 커미션을 500이라고 변경하자.

```sql
UPDATE TEST
SET COMM=500
WHERE ENAME='FORD';
```

```sql
SELECT *
FROM TEST
WHERE ENAME='FORD';
-FORD의 커미션을 확인해보자.
```



Q8) TEST 테이블에서 PAUL의 직업은 CLERK로 봉급은 5000, 커미션은 봉급의 20%로 변경해보자.

```sql
UPDATE TEST
SET JOB='CLERK', SAL=5000, COMM=SAL*0.2
WHERE ENAME='PAUL';
--이거하면 SAL에 5000들어가나 ;으로 문장이 안끝난채로 COMM이 실행되니 NULL이 뜸
```

```sql
UPDATE TEST
SET JOB='CLERK', SAL=5000, COMM=SAL*0.2
WHERE ENAME='PAUL';
```

이문제를 좀더 생각해보자.





Q9) 서브쿼리를 사용해서 사원의 번호 7902 사원의 부서번호를 KING과 동일하게 변경하는 UPDATE를 해보자.

```sql
UPDATE TEST
SET DEPTNO = (SELECT DEPTNO
              FROM TEST
              WHERE ENAME='KING')
WHERE EMPNO = 7902;
```



Q10) 7698사원의 직업과 부서번호를 7499사원의 직업과 부서번호와 같도록 수정하자.

```sql
UPDATE TEST
SET (JOB, DEPTNO) = (SELECT JOB, DEPTNO
                     FROM TEST
                     WHERE EMPNO=7499)
WHERE EMPNO=7698;                    
```

















---

DELETE

















오전은 다시보기로 채우자.

---

오후수업





Method oracle/jdbc/driver/OracleCallableStatementWrapper.isClosed()Z is abstract



























