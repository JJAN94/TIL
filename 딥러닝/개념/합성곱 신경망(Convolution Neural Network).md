# 합성곱 신경망(Convolution Neural Network)

합성곱 신경망은 이미지나 영상을 처리하는데 유용하다.

기존의 신경망을 사용할 때는 데이터를 flatten(dense)으로 만들어서 학습을 시켰다.

이미지나 영상 데이터를 flattening하면 데이터에 담겨있는 공간적 특성(spatial feature)가 손실된다. 이를 방지하고 도입한 개념이 합성곱 신경망이다.



# 구조

음성인식, 이미지, 영상 인식에 주로 사용되는 신경망이다.

다차원 배열 데이터를 처리하도록 구성되어 컬러 이미지 같은 다차원 배열 처리에 특화되어 있으며, 5개의 계층 구조를 갖는다.

- 입력층
- 합성곱층
- 풀링층
- 완전연결층
- 출력층

합성곱층과 풀링층을 거치면서 입력 이미지의 주요 특성 벡터를 추출한다. 완전연결층에서 추출된 벡터들을 flatten하여 학습을 한 후 출력층에 sigmoid 또는 softmax로 전달 된다.



## 입력층

입력층에는 데이터의 입력 차원에 따라 데이터가 전달된다.

그레이레벨의 영상은 (h,w,1), 컬러레벨 영상은 (h,w,3)이 들어가며, 컬러 레벨은 RGB 표현을 따라 3차원으로 표현



## 합성곱층

데이터에서 특성을 추출하는 역할 수행

커널(kernel)이나 필터를 사용해 특성을 추출하는데, 이때 추출된 결과물을 특성맵(feature map)이라 한다.



정확히 구분하면 필터는 여러개의 kernel로 구성되어 있으며 2차원의 kernel이 channel수만큼 모여 fillter를 이루는 것.



- Conv 연산 적용 후 출력 피처맵의 크기

  $$ O = \frac{I - F +2P}{S} + 1$$

  - I : 입력 피처맵의 크기
  - F : 필터의 크기(kernel size)
  - P : 패딩 크기
  - S : stride 크기



## 풀링층

합성곱층과 유사하게 특성맵의 차원을 다운 샘플링하여 연산량을 감소시키고, 주요한 특성 벡터를 추출하여 학습 효과를 높여준다.

> 다운 샘플링(sub-sampling) : 이미지를 축소 하는 것

- max pooling : 대상 영역에서 최대값 추출
- average pooling : 대상 영역에서 평균을 구해 추출

대부분의 과정에서 max pooling사용

average pooling은 각 커널 값을 평균화 시켜 중요한 가중치를 갖는 값의 특성이 희미해질 수 있기때문이다.



## 완전연결층

fully connected layer, 기존의 신경망과 동일



## 출력층

sigmoid, softmax를 사용해 이진분류, 다중분류를 수행하는 층.

최종 결과를 확률로 얻어 출력한다.



